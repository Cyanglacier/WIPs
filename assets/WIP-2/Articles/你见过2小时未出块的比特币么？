你见过2小时未出块的比特币么？
Author: Cyanglacier
Mail: onemice@126.com

3月12日是令币圈难忘的一天，在这一天比特币惊现40%以上的跌幅，由最高7966Usdt跌至最低4410Usdt，无数人在这一天倾家荡产；3月12日也是令链圈难忘的一天，同样是比特币，3月12日晚上区块高度为621343的区块，历时1小时才出块，无独有偶，在3月15日下午区块高度为621701的区块，历时约2小时才成功挖出。而距离上一次比特币出块时间异常则要追溯到2019年10月区块高度为59727319的区块。也许单纯从出块时间来看，这不过是两次出块时间的异常，毕竟比特币平均10分钟的出块间隔已被无数人吐槽“慢”，毕竟一小时不过6个区块而交易所普遍的区块确认时间也近乎1小时，用户的比特币体验依旧是缓慢的。但从概率上来说，对于具备一定自适应机制的比特币网络，出现出块间隔大于110分钟的概率近乎0.000679%（数据来自：Antoine Le Calvez），如此低概率的事情在短时间内连续出现，其背后的原因值得我们分析。
</I 巴菲特不仅在89岁目睹了3次美股熔断，也目睹了比特币网络连续两次出块时间异常 /I>

</B 比特币的出块时间调整机制 /B>
根据白皮书，比特币的出块间隔近乎10分钟，每2016个区块调整一次难度以让下一区间（2016个）的出块间隔近乎10分钟。由于比特币采用了工作量证明，矿工需要投入算力与电费才能竞争出块，同时网络根据所有矿工算力总和，每隔2016个区块调整一次网络难度。在理想情况下，网络算力缓慢增长或下跌，即便部分区块的出块时间略微延长/缩短，每2016个区块周期内，平均出块间隔也将趋近于10分钟。
但是，由于矿工在工作量证明中投入的矿机、电费、场地费等等成为了挖矿成本，矿工与矿工间由于资源不同，相应的挖矿成本也会存在差距，如果当前挖矿的成本基本等于甚至高于预期挖矿收益，从理性角度看，矿工的理智决策应当是关机撤出网络并评估矿机剩余价值（当然不乏矿工选择倒贴成本屯币挖矿）。当矿工群体在某一时间段集中退出网络，网络算力骤降且距离下一次难度调整还有一段时间的时候，就会出现网络出块时间延长甚至网络出块困难的情况。从这个角度我们不难理解为何近期会连续出现两次出块困难了——3月12日，随着比特币价格的迅速下跌，由于网络算力并未第一时间减少，矿工的预期收益随着价格下跌而降低，当价格下降到某个临界值时，比特币的预期收益击穿成本线，矿工不得不关机以避免进一步的亏损，网络算力骤降（实际上，从3月5日至3月15日，比特币网络算力从130EH迅速降低到95EH）而难度调整周期尚未到来。连续两次下跌，清退部分矿工导致算力下降的同时，也让网络算力无法支撑网络难度，比特币的部分区块出块时间延长。当然，比特币的算力市场依然遵循着市场规律，大量矿工的清退也让成本较低的矿工得以入场，加上难度调整周期的到来，近期比特币网络已相对稳定，暂未出现出块时间明显延长的情况。

</B 问题已至，如何解决 /B>
这并不是比特币第一次出现出块时间异常的情况，在2014年5月与2019年10月也因网络难度原因出现过类似情况，对于比特币等Coin类区块链而言，由于其目标为支付与储值手段，如果交易出现卡顿甚至明显延迟，将会对网络信任造成影响，假若网络持续出现出块时间不稳定的情况，势必会影响其正常使用并严重影响用户的信任度。
</I 所谓不患寡而患不均，如果网络出块时间稳定，即使慢如比特币的10分钟，用户也不会因此拒绝使用比特币；相反如果出块时间波动较大，用户无法评估未来的交易确认时间，那么用户很有可能不会使用该网络，换句话说，该网络失去了信任 /I>
信任，既是区块链应当解决的问题，也是区块链的立身之本，为了避免类似情况的发生，目前行业内提出了数种解决方案：
1、在保留工作量证明的情况下，降低难度调整间隔期：以比特币现金为例，其采用了降低出块难度调整间隔（早期从2016个区块降低为144个区块，目前为逐块调整难度）、EDA紧急算力调整机制（若连续6个区块出块时间差超过12个小时，则难度系数下降20%）等；其他的工作量证明网络多采取根据上一区块出块速度调整难度的动态难度调整机制。
2、使用权益证明或授权股权证明（DPoS）：在权益证明与授权股权证明中，挖矿成本不再由电费与矿机决定，矿工根据质押比例获得相应的出块权利，由于挖矿成本被转化为了锁定流动性，一方面矿工的后期投入下降，已成为“出块节点”的矿工仅需要维持基础运行即可获取质押收益，变相提高了网络对矿工的粘性；另一方面，多数权益证明和授权股权证明都设置有解锁周期，避免矿工频繁出入网络导致算力波动，继而减少区块出块时间异常的频率。
3、其他方法，例如EOS共识中的BFT部分，使用顺序出块规则，让单个节点连续产出数个区块，同时节点出块沿一定顺序而非乱序，以此缩短出块间隔并让出块连续性提升；将VRF（可验证随机函数）引入区块共识中，按照集体划分出块顺序，在给定区块区间内由部分经VRF挑选出的节点出块，达到连续出块并避免出块时间异常的效果等等。
以上仅是笔者整理的部分具有代表性之解决方案，行业内还有诸多理论上或早已实践的解决方案。但技术不是完美的，目前所提到的方案都或多或少存在局限性。

</B 没有完美的技术 /B>
虽然前文提到了几种典型的解决比特币出块时间异常的技术方案，但正如不存在完美的人一般，由人开发的技术也必定存在不完美。
以比特币现金为例，虽然其创造性的采用了EDA，避免了分叉早期原链与分叉链算力差过大以至于难度无法调整，继而引起网络瘫痪的问题，但EDA本身也成为其出块间隔异常的原因————当大量算力不断涌入与撤出网络时，EDA会错误的降低网络难度，导致区块间隔时间的波动（如17年11月分叉初期，比特币现金出快速度最快可达到1分钟左右，远远低于10分钟的要求）。波动的网络出块时间，不仅削弱了小矿工实力，加剧算力中心化，还令区块高度增加过快，单个区块的空间利用率降低（即空块率提高），浪费了网络性能。
而对于权益证明与DPoS而言，尽管矿工粘性上升，但相对于工作量证明，无疑提高了准入门槛并降低了网络去中心化成都，尤其是DPoS。中心化与去中心化孰优孰劣，我们暂不讨论。对于区块链而言，本身是作为去信任的机器而存在，如果去中心化程度不断下降，最后达到和中心化一样的程度，颇有买椟还珠之意。掌握去中心化的安全与中心化的效率之间的平衡更是难上加难。
技术不存在完美，但相互补充的技术却能有效降低短板带来的影响，在区块链中也是如此。
既然2016个区块才调整难度会引起出块时间异常，那么就采用动态难度调整法，每个区块都进行难度调整，让出块时间尽可能地趋近某一平均值；单纯的DPoS会削弱网络去中心化程度，那么就用工作量证明与授权股权证明结合的方法，将锁定流动性加入挖矿成本中，加固矿工与网络的纽带，避免短时间内大量算力的进入或撤离，令网络算力稳定变化；辅以顺序出块原则，缩短出块间隔，提高用户使用体验。以上技术的整合，即是智慧链Wisdomchain。
当然，我们无法肯定此种方案即是最佳解决方案，因为目前目前区块链领域获得了无数集体与个人的青睐，随着时间推进，更多更优秀的解决方案必定会不断提出。回顾主网上线以来，Wusdiomchain的出块延迟几乎稳定于8秒，出块节点的变化并未影响到网络的稳定性，我们相信智慧链的技术解决方案实际具备可行性，也将不断推广，不断进化。从技术中诞生，也必将反哺技术。
